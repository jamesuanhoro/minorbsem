<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Fit Bayesian structural equation models under the assumption that minor factors exist • minorbsem</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Fit Bayesian structural equation models under the assumption that minor factors exist">
<meta name="description" content="Structural equation models (SEMs) rarely reject the null hypothesis that there is no model misspecification. One explanation for this problem is that covariance structures are influenced by major factors which we can hypothesize about and minor factors which we cannot predict a-priori.">
<meta property="og:description" content="Structural equation models (SEMs) rarely reject the null hypothesis that there is no model misspecification. One explanation for this problem is that covariance structures are influenced by major factors which we can hypothesize about and minor factors which we cannot predict a-priori.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">minorbsem</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.15.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-examples" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Examples</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-examples">
<li><a class="dropdown-item" href="articles/cfa.html">Confirmatory Factor Analysis</a></li>
    <li><a class="dropdown-item" href="articles/priors.html">Detailed guide to setting priors</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jamesuanhoro/minorbsem/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="minorbsem">minorbsem<a class="anchor" aria-label="anchor" href="#minorbsem"></a>
</h1></div>
<!-- badges: start -->

<div class="section level4">
<h4 id="table-of-contents">Table of Contents<a class="anchor" aria-label="anchor" href="#table-of-contents"></a>
</h4>
<ul>
<li>
<a href="#package-overview">Package overview</a>
<ul>
<li><a href="#goals">Goals</a></li>
<li><a href="#permitted-models-and-supported-data-types">Permitted models and supported data types</a></li>
</ul>
</li>
<li><a href="#installation">Installation</a></li>
<li><a href="#a-reasonably-complete-demonstration">A reasonably complete demonstration</a></li>
<li>
<a href="#additional-examples">Additional examples</a>
<ul>
<li><a href="#different-methods-to-capture-the-influence-of-minor-factors">Different methods to capture the influence of minor factors</a></li>
<li><a href="#relax-simple-structure">Relax simple structure</a></li>
</ul>
</li>
<li><a href="#contributions-are-encouraged">Contributions are encouraged</a></li>
<li><a href="#citations">Citations</a></li>
</ul>
</div>
<div class="section level2">
<h2 id="package-overview">Package overview<a class="anchor" aria-label="anchor" href="#package-overview"></a>
</h2>
<p>Structural equation models (SEMs) rarely reject the null hypothesis that there is no model misspecification. One explanation for this problem is that covariance structures are influenced by major factors which we can hypothesize about and minor factors which we cannot predict a-priori, e.g. MacCallum and Tucker (1991).</p>
<div class="section level3">
<h3 id="goals">Goals<a class="anchor" aria-label="anchor" href="#goals"></a>
</h3>
<p>The goal of <code>minorbsem</code> is to facilitate fitting Bayesian SEMs that estimate the influence of minor factors on the covariance matrix, following the approach in Uanhoro (2023). Briefly, the method estimates all residual covariances with priors that shrink them towards zero, and the model returns the magnitude of the influence of minor factors.</p>
<p>The package also allows you set priors on all substantive model parameters directly. Importantly, prior distributions assume latent variables have a total variance of 1, even in latent regression models.</p>
</div>
<div class="section level3">
<h3 id="permitted-models-and-supported-data-types">Permitted models and supported data types<a class="anchor" aria-label="anchor" href="#permitted-models-and-supported-data-types"></a>
</h3>
<p>The package is able to fit a variety of model configurations:</p>
<ul>
<li>CFA, allowing automatically estimated penalized cross-loadings</li>
<li>Path models with latent and observed variables
<ul>
<li>Any observed variables in a structural model must be represented with a single-indicator latent variable with the error variance of the observed variable constrained to 0</li>
</ul>
</li>
</ul>
<p>The package is also able to <strong>analyze correlation structures</strong> using methods in Archakov and Hansen (2021). This includes polychoric correlation matrices as long as an asymptotic variance matrix is provided. The relevant paper is under review at Structural Equation Modeling.</p>
<p>The package does not support fitting multi-group or multilevel models. See the <a href="https://github.com/jamesuanhoro/bayesianmasem" class="external-link">bayesianmasem</a> package for multi-group factor analysis via meta-analysis methods.</p>
</div>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p><code>minorbsem</code> is hosted on GitHub, so we need the <code>remotes</code> package to install it. We also need to install the <code>cmdstanr</code> package and CmdStan in order to use Stan.</p>
<p>Instructions:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span>  <span class="co"># install remotes</span></span>
<span></span>
<span><span class="co"># next install cmdstanr and CmdStan:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span></span>
<span>  <span class="st">"cmdstanr"</span>,</span>
<span>  repos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"https://mc-stan.org/r-packages/"</span>, <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"repos"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">cmdstanr</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/cmdstanr/reference/install_cmdstan.html" class="external-link">check_cmdstan_toolchain</a></span><span class="op">(</span>fix <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">cmdstanr</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/cmdstanr/reference/install_cmdstan.html" class="external-link">install_cmdstan</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Then finally minorbsem:</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"jamesuanhoro/minorbsem"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="a-reasonably-complete-demonstration">A reasonably complete demonstration<a class="anchor" aria-label="anchor" href="#a-reasonably-complete-demonstration"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jamesuanhoro.github.io/minorbsem/">minorbsem</a></span><span class="op">)</span></span>
<span><span class="co"># Basic Holzinger-Swineford model</span></span>
<span><span class="va">syntax_1</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">F1 =~ x1 + x2 + x3</span></span>
<span><span class="st">F2 =~ x4 + x5 + x6</span></span>
<span><span class="st">F3 =~ x7 + x8 + x9"</span></span>
<span><span class="co"># Expect a summary table output</span></span>
<span><span class="va">fit_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/minorbsem.html">minorbsem</a></span><span class="op">(</span><span class="va">syntax_1</span>, <span class="va">HS</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save output table to html file, see: ?pretty_print_summary for more options</span></span>
<span><span class="fu"><a href="reference/pretty_print_summary.html">pretty_print_summary</a></span><span class="op">(</span><span class="va">fit_1</span>, save_html <span class="op">=</span> <span class="st">"baseline_model.html"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Histogram of parameters, see: ?parameter_hist for arguments</span></span>
<span><span class="fu"><a href="reference/parameter_hist.html">parameter_hist</a></span><span class="op">(</span><span class="va">fit_1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Traceplot of parameters, see: ?parameter_trace for arguments</span></span>
<span><span class="fu"><a href="reference/parameter_trace.html">parameter_trace</a></span><span class="op">(</span><span class="va">fit_1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Examine all standardized residual covariances</span></span>
<span><span class="fu"><a href="reference/plot_residuals.html">plot_residuals</a></span><span class="op">(</span><span class="va">fit_1</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/plot_residuals.html">plot_residuals</a></span><span class="op">(</span><span class="va">fit_1</span>, type <span class="op">=</span> <span class="st">"range"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="additional-examples">Additional examples<a class="anchor" aria-label="anchor" href="#additional-examples"></a>
</h2>
<div class="section level3">
<h3 id="different-methods-to-capture-the-influence-of-minor-factors">Different methods to capture the influence of minor factors<a class="anchor" aria-label="anchor" href="#different-methods-to-capture-the-influence-of-minor-factors"></a>
</h3>
<p>Default method above is <code>method = "normal"</code> assuming standardized residual covariances are on average 0 and vary from 0 in continuous fashion.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit same model as above but use global-local prior to estimate</span></span>
<span><span class="co"># minor factor influences</span></span>
<span><span class="va">fit_gdp</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/minorbsem.html">minorbsem</a></span><span class="op">(</span><span class="va">syntax_1</span>, <span class="va">HS</span>, method <span class="op">=</span> <span class="st">"GDP"</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/plot_residuals.html">plot_residuals</a></span><span class="op">(</span><span class="va">fit_gdp</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/parameter_hist.html">parameter_hist</a></span><span class="op">(</span><span class="va">fit_gdp</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/parameter_trace.html">parameter_trace</a></span><span class="op">(</span><span class="va">fit_gdp</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ignoring minor factor influences</span></span>
<span><span class="va">fit_none</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/minorbsem.html">minorbsem</a></span><span class="op">(</span><span class="va">syntax_1</span>, <span class="va">HS</span>, method <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/parameter_hist.html">parameter_hist</a></span><span class="op">(</span><span class="va">fit_none</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/parameter_trace.html">parameter_trace</a></span><span class="op">(</span><span class="va">fit_none</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Error!!!: Plotting residuals will give an error message</span></span>
<span><span class="co"># since minor factor influences are assumed null</span></span>
<span><span class="fu"><a href="reference/plot_residuals.html">plot_residuals</a></span><span class="op">(</span><span class="va">fit_none</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="relax-simple-structure">Relax simple structure<a class="anchor" aria-label="anchor" href="#relax-simple-structure"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_complex</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/minorbsem.html">minorbsem</a></span><span class="op">(</span><span class="va">syntax_1</span>, <span class="va">HS</span>, simple_struc <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>There are other methods, see details section in <code><a href="reference/minorbsem.html">?minorbsem</a></code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="contributions-are-encouraged">Contributions are encouraged<a class="anchor" aria-label="anchor" href="#contributions-are-encouraged"></a>
</h2>
<p>All users of R (or SEM) are invited to submit functions or ideas for functions.</p>
<p>Feel free to:</p>
<ul>
<li>
<a href="https://github.com/jamesuanhoro/minorbsem/issues/" class="external-link">open an issue</a> to report a bug or to discuss recommendations;</li>
<li>submit pull requests to recommend modifications or suggest improvements.</li>
</ul>
<p>You can also email the package maintainer, James Uanhoro (James dot Uanhoro at unt dot edu). Thank you for helping improve minorbsem :).</p>
</div>
<div class="section level2">
<h2 id="citations">Citations<a class="anchor" aria-label="anchor" href="#citations"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-archakov_new_2021" class="csl-entry">
Archakov, Ilya, and Peter Reinhard Hansen. 2021. “A New Parametrization of Correlation Matrices.” <em>Econometrica</em> 89 (4): 1699–1715. <a href="https://doi.org/10.3982/ECTA16910" class="external-link uri">https://doi.org/10.3982/ECTA16910</a>.
</div>
<div id="ref-maccallum_representing_1991" class="csl-entry">
MacCallum, Robert C., and Ledyard R. Tucker. 1991. “Representing Sources of Error in the Common-Factor Model: Implications for Theory and Practice.” <em>Psychological Bulletin</em> 109 (3): 502–11. <a href="https://doi.org/10.1037/0033-2909.109.3.502" class="external-link uri">https://doi.org/10.1037/0033-2909.109.3.502</a>.
</div>
<div id="ref-uanhoro_modeling_2023" class="csl-entry">
Uanhoro, James Ohisei. 2023. “Modeling Misspecification as a Parameter in Bayesian Structural Equation Models.” <em>Educational and Psychological Measurement</em> 0 (0): 00131644231165306. <a href="https://doi.org/10.1177/00131644231165306" class="external-link uri">https://doi.org/10.1177/00131644231165306</a>.
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/jamesuanhoro/minorbsem/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/jamesuanhoro/minorbsem/issues/" class="external-link">Report a bug</a></li>
<li><a href="mailto:James.Uanhoro@unt.edu">Ask a question / Make a suggestion</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing minorbsem</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>James O. Uanhoro <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-4843-927X" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://www.repostatus.org/#active" class="external-link"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active The project has reached a stable, usable state and is being actively developed."></a></li>
<li><a href="https://app.codecov.io/gh/jamesuanhoro/minorbsem?branch=master" class="external-link"><img src="https://codecov.io/gh/jamesuanhoro/minorbsem/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://cran.r-project.org/" class="external-link"><img src="https://img.shields.io/badge/R%3E%3D-3.4.0-6666ff.svg" alt="minimal R version"></a></li>
<li><a href="https://cran.r-project.org/package=minorbsem" class="external-link"><img src="https://www.r-pkg.org/badges/version/minorbsem" alt="CRAN_Status_Badge"></a></li>
<li><a href="https://github.com/jamesuanhoro/minorbsem/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/jamesuanhoro/minorbsem/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://joss.theoj.org/papers/c0cd5b1a2d66bbf21fb00d237f646180" class="external-link"><img src="https://joss.theoj.org/papers/c0cd5b1a2d66bbf21fb00d237f646180/status.svg" alt="JOSS-paper"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by James O. Uanhoro.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
